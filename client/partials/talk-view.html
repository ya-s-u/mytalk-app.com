<div id="top" ng-init="user='後藤 誉昌'">
	<a href="/mypage" class="back icon-back"></a>
	<div id="title">
		<img src="img/icon/RoundIcons-Free-Set-01.png">
		<p>{{head.title}}</p>
		<span class="app line"></span>
	</div>
	<ul id="button">
		<li id="talk-setting" class="mbutton"><span class="icon icon-setting"></span>設定</li>
		<li id="talk-share" class="mbutton"><span class="icon icon-heart"></span>共有する</li>
	</ul>
</div>
<div id="left">
	<div id="info" class="segment">
		<p class="segment_top">トーク情報<span class="icon icon-info"></span></p>
		<ul class="segment_body">
			<li><span>投稿数</span>{{head.count}}</li>
			<li><span>期間</span>{{parseDate(head.start) | date:'yyyy,M'}}〜{{parseDate(head.end) | date:'yyyy,M'}}</li>
			<li><span>更新</span>{{parseDate(head.created) | date:'yyyy,M,d'}}</li>
		</ul>
	</div>
	<div id="member" class="segment">
		<p class="segment_top">メンバー<span class="icon icon-user"></span></p>
		<ul class="segment_body">
			<li ng-repeat="data in member | limitTo:5" ng-class="{'others':data.name!=user}" class="others-1">{{data.name}}<span>{{data.count}}</span></li>
		</ul>
	</div>
</div>
<div id="right">
	<div id="head">
		<span ng-click="setDate(year,month-1)" id="prev" class="move icon-left"></span>
		<div id="current">
			<p id="now">{{year}}年{{month}}月</p>
			<p id="count">{{count}}トーク</p>
			<span class="icon-down"></span>
			<!--
			<ul id="date_menu">
				<li>
					<p>2014/3</p>
					<ul class="log">
						<li><span style="height:60%;"></span></li>
						<li><span style="height:20%;"></span></li>
						<li><span style="height:00%;"></span></li>
						<li><span style="height:30%;"></span></li>
						<li><span style="height:100%;"></span></li>
						<li><span style="height:10%;"></span></li>
						<li><span style="height:60%;"></span></li>
						<li><span style="height:90%;"></span></li>
						<li><span style="height:00%;"></span></li
						><li><span style="height:60%;"></span></li>
						<li><span style="height:30%;"></span></li>
						<li><span style="height:10%;"></span></li>
						<li><span style="height:80%;"></span></li>
						<li><span style="height:60%;"></span></li>
						<li><span style="height:90%;"></span></li>
						<li><span style="height:90%;"></span></li>
						<li><span style="height:100%;"></span></li>
						<li><span style="height:60%;"></span></li>
						<li><span style="height:100%;"></span></li>
						<li><span style="height:20%;"></span></li>
						<li><span style="height:30%;"></span></li>
						<li><span style="height:20%;"></span></li>
						<li><span style="height:80%;"></span></li>
						<li><span style="height:10%;"></span></li>
						<li><span style="height:30%;"></span></li>
						<li><span style="height:20%;"></span></li>
						<li><span style="height:30%;"></span></li>
						<li><span style="height:90%;"></span></li>
						<li><span style="height:70%;"></span></li>
						<li><span style="height:60%;"></span></li>
						<li><span style="height:80%;"></span></li>
					</ul>
				</li>
			</ul>
			-->
		</div>
		<span ng-click="setDate(year,month+1)" id="next" class="move icon-right"></span>
	</div>

	<ul id="talk" class="line">
		<li ng-repeat="data in timeline | orderBy:'date'"
			ng-class="{'me':data.name==user, 'others':data.name!=user, 'others-1':data.name!=user}">
			<div class="box">
				<p ng-hide="data.name==user" id="name">{{data.name}}</p>
				<p id="text" ng-bind-html="data.value | linky">
					<span class="date">{{parseDate(data.date) | date:'M/d'}}<br>{{parseDate(data.date) | date:'a h:m'}}</span>
				</p>
			</div>
		</li>
	</ul>
</div>

<script>
$('.mbutton').click(function(){
    var idName = $(this).attr('id');

    $('body').append('<div id="overlay"></div>');
    $('#overlay').show();
    $('.modal').attr("id",idName);
    $('.modal').show();
    centering();
    $('body').css({"overflow":"hidden"});
    $('.modal').load("../modals/"+idName+".html");

    $(window).on('touchmove.noScroll',function(e) {
        e.preventDefault();
    })

    var timer = false;
    $(window).resize(function() {
        if (timer !== false) {
            clearTimeout(timer);
        }
        timer = setTimeout(function() {
            centering();
        }, 200);
    });

    $('#overlay, .modal> a.close').click(function(){
        $('.modal,#overlay').hide();
        $('.modal').attr("id","");
        $('.modal').children().remove();
        $('#overlay').remove();
        $('body').css({"overflow":"auto"});
        $(window).off('.noScroll');
    });

    function centering() {
        var box_width = $('.modal').outerWidth();
        var box_height = $('.modal').outerHeight();
        var window_width = $(window).outerWidth();
        var window_height = $(window).outerHeight();
        var top = (window_height-box_height)/2;
        var left = (window_width-box_width)/2;
        $('.modal').css({"top":top,"left":left});
    };
});
</script>

<script>
/*
$("#current").hover(function() {
	$("ul#date_menu").show();
}, function() {
	$("ul#date_menu").hide();
});
*/
</script>


<script type="text/javascript">
$(function(){
	$(window).scroll(function () {
		var ScrTop = $(document).scrollTop();

		if(ScrTop > 50) {
			//$("#header").css({"position":"fixed","z-index":"100"});
			$("#header").css({"position":"fixed","top":"-50px"});
			$("#top").css({"position":"fixed","top":"5px"});
			$("#left").css({"position":"fixed","opacity":"0.5"});
			$("#talk").css({"position":"absolute","top":"50px"});
			$("#head").css({"position":"fixed","top":"80","box-shadow":"0 1px 1px rgba(200,200,200,.5)"});
		} else {
			$("#header").css({"position":"inherit"});
			$("#top").css({"position":"absolute","top":"0"});
			$("#left").css({"position":"absolute","opacity":"1.0"});
			$("#talk").css({"position":"inherit","top":"0"});
			$("#head").css({"position":"absolute","top":"0","box-shadow":"none"});
		}
	});
});
</script>
